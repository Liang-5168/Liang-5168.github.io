<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#970C10" />
  <title>唱給不在場的人</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&display=swap" rel="stylesheet" />

  <style>
    :root{
      --red:#970C10;
      --gold:#FFE87A;
      --ink:#000;
      --card:rgba(255,255,255,0.06);
      --card-border:rgba(255,255,255,0.14);
      --text:rgba(255,255,255,0.92);
      --muted:rgba(255,255,255,0.70);
      --focus:rgba(255,232,122,0.95);
      --navH: 92px;
    }

    *{margin:0;padding:0;box-sizing:border-box;}
    html{
      scroll-behavior:smooth;
      text-rendering:optimizeLegibility;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    body{
      font-family:"Noto Serif TC", serif;
      background:#000;
      color:#fff;
      overflow-x:hidden;
    }
    a{color:inherit;}
    a:focus-visible, button:focus-visible{
      outline:2px solid var(--focus);
      outline-offset:3px;
      border-radius:10px;
    }

    .skip-link{
      position:absolute;
      left:-999px;
      top:10px;
      z-index:9999;
      background:rgba(0,0,0,0.85);
      border:1px solid rgba(255,255,255,0.20);
      color:#fff;
      padding:10px 12px;
      border-radius:12px;
      letter-spacing:0.08em;
    }
    .skip-link:focus{left:10px;}

    /* ===== CSS grain (no external file) ===== */
    .grainy::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0.22;
      mix-blend-mode:overlay;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.06), rgba(255,255,255,0.06) 1px, rgba(0,0,0,0) 1px, rgba(0,0,0,0) 3px),
        repeating-linear-gradient(90deg, rgba(255,255,255,0.05), rgba(255,255,255,0.05) 1px, rgba(0,0,0,0) 1px, rgba(0,0,0,0) 4px);
      filter: blur(0.2px);
    }

    /* =========================
       Atmosphere: fog / smoke
       ========================== */
    .fog-layer{
      position:fixed;
      inset:-30vh -20vw -30vh -20vw;
      pointer-events:none;
      z-index:20;
      opacity:0.22;
      mix-blend-mode:screen;
      filter: blur(8px) contrast(110%);
      background:
        radial-gradient(closest-side at 20% 30%, rgba(255,255,255,0.16), rgba(255,255,255,0) 70%),
        radial-gradient(closest-side at 70% 55%, rgba(255,232,122,0.12), rgba(255,255,255,0) 72%),
        radial-gradient(closest-side at 35% 80%, rgba(255,255,255,0.14), rgba(255,255,255,0) 72%);
      animation:fog-drift 18s ease-in-out infinite;
    }
    .fog-layer::before,
    .fog-layer::after{
      content:"";
      position:absolute;
      inset:0;
      background:
        radial-gradient(closest-side at 55% 25%, rgba(255,255,255,0.10), rgba(255,255,255,0) 70%),
        radial-gradient(closest-side at 85% 75%, rgba(255,255,255,0.10), rgba(255,255,255,0) 70%),
        radial-gradient(closest-side at 10% 65%, rgba(255,255,255,0.08), rgba(255,255,255,0) 70%);
      animation:fog-drift-2 24s ease-in-out infinite;
      opacity:0.85;
      transform:translate3d(0,0,0);
    }
    .fog-layer::after{
      animation:fog-drift-3 30s ease-in-out infinite;
      opacity:0.55;
      filter: blur(12px);
    }
    @keyframes fog-drift{
      0%{transform:translate3d(-2vw, -1vh, 0) scale(1.02);}
      50%{transform:translate3d(2vw, 1.2vh, 0) scale(1.05);}
      100%{transform:translate3d(-2vw, -1vh, 0) scale(1.02);}
    }
    @keyframes fog-drift-2{
      0%{transform:translate3d(2vw, 0, 0) rotate(0.001deg);}
      50%{transform:translate3d(-2vw, 1vh, 0) rotate(0.001deg);}
      100%{transform:translate3d(2vw, 0, 0) rotate(0.001deg);}
    }
    @keyframes fog-drift-3{
      0%{transform:translate3d(0, 1vh, 0) scale(1.06);}
      50%{transform:translate3d(1.5vw, -1vh, 0) scale(1.02);}
      100%{transform:translate3d(0, 1vh, 0) scale(1.06);}
    }

    /* =========================
       Section 1｜Full-screen Video
       ========================== */
    .landing-video{
      position:relative;
      width:100%;
      height:100vh;
      overflow:hidden;
      background:#000;
    }
    .landing-video video{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
    }
    .landing-video::after{
      content:"";
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.28);
      z-index:1;
    }

    /* =========================
       Section 2｜Buffer Zone
       ========================== */
    .buffer{
      position:relative;
      height:60vh;
      background:var(--red);
      overflow:hidden;
    }
    .buffer.grainy{position:relative;}

    /* =========================
       Section 3｜Hero
       ========================== */
    .hero{
      position:relative;
      height:100vh;
      min-height:100vh;
      background:var(--red);
      overflow:visible;
      display:flex;
      align-items:center;
      padding:0 7vw;
      gap:min(6vw,64px);
      isolation:isolate;
    }
    .hero.grainy{position:relative;}

    .hero-image{
      position:absolute;
      right:0;
      bottom:0;
      display:flex;
      justify-content:flex-end;
      align-items:flex-end;
      z-index:2;
      pointer-events:none;
      filter:saturate(1.02) contrast(1.02);
    }
    .hero-image img{
      width:clamp(420px,60vw,920px);
      max-height:92vh;
      height:auto;
      object-fit:cover;
      border-top-left-radius:28px;
      box-shadow:0 30px 90px rgba(0,0,0,0.55);
    }
    .hero-content{
      position:relative;
      z-index:3;
      flex:0 1 48%;
      max-width:640px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      min-height:100%;
    }
    .hero h1{
      font-size:clamp(2.5rem,5vw,4rem);
      font-weight:900;
      color:var(--gold);
      margin-bottom:1rem;
      letter-spacing:0.05em;
    }
    .hero h2{
      font-size:clamp(1.4rem,3vw,2.2rem);
      font-weight:700;
      color:var(--gold);
      margin-bottom:1.5rem;
    }
    .hero h3{
      font-size:clamp(1rem,2.2vw,1.3rem);
      font-weight:600;
      color:#fff;
      letter-spacing:0.08em;
      margin-bottom:2rem;
    }
    .hero h1, .hero h2{white-space:nowrap;}

    .typewriter-line{
      display:inline-block;
      position:relative;
      min-height:1em;
      overflow:hidden;
    }
    .typewriter-line.typing::after{
      content:"";
      position:absolute;
      right:-0.1em;
      top:50%;
      transform:translateY(-50%);
      height:1.2em;
      width:2px;
      background:var(--gold);
      animation:caret-blink 0.8s steps(1) infinite;
    }
    .typewriter-line.done::after{animation:none;opacity:0;}

    .hero-entrance{
      opacity:0;
      transform:translateY(20px);
      transition:opacity 0.9s ease-out, transform 0.9s ease-out;
      transition-delay:var(--delay,0ms);
    }
    .hero-entrance.is-visible{opacity:1;transform:translateY(0);}

    .scroll-hint{
      position:absolute;
      bottom:3rem;
      left:50%;
      transform:translate(-50%,0.5rem);
      font-size:0.9rem;
      letter-spacing:0.3em;
      text-transform:uppercase;
      color:rgba(255,255,255,0.85);
      opacity:0;
      transition:opacity 0.6s ease, transform 0.6s ease;
      pointer-events:none;
      z-index:4;
    }
    .scroll-hint.visible{
      opacity:1;
      transform:translate(-50%,0);
      animation:hint-float 2s ease-in-out infinite;
    }

    @keyframes caret-blink{0%,49%{opacity:1;}50%,100%{opacity:0;}}
    @keyframes hint-float{0%{transform:translate(-50%,0);}50%{transform:translate(-50%,-8px);}100%{transform:translate(-50%,0);}}

    /* =========================
       Sticky Mini Nav + Progress
       ========================== */
    .mini-nav{
      position:sticky;
      top:0;
      z-index:60;
      backdrop-filter:blur(10px);
      background:rgba(0,0,0,0.55);
      border-bottom:1px solid rgba(255,255,255,0.10);
    }
    .mini-nav-inner{
      display:flex;
      align-items:center;
      gap:1rem;
      padding:0.75rem 6vw 0.65rem;
      overflow-x:auto;
      scrollbar-width:none;
    }
    .mini-nav-inner::-webkit-scrollbar{display:none;}
    .mini-nav a{
      color:rgba(255,255,255,0.78);
      text-decoration:none;
      font-size:0.9rem;
      letter-spacing:0.12em;
      white-space:nowrap;
      padding:0.35rem 0.65rem;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.12);
      transition:0.25s ease;
    }
    .mini-nav a:hover{color:#fff;border-color:rgba(255,255,255,0.24);}
    .mini-nav a.active{color:#000;background:var(--gold);border-color:transparent;}

    .progressbar{
      height:3px;
      background:rgba(255,255,255,0.10);
      margin:0 6vw 0.65rem;
      border-radius:999px;
      overflow:hidden;
    }
    .progressbar > div{
      height:100%;
      width:0%;
      background:var(--gold);
      border-radius:999px;
      transition:width 0.1s linear;
    }

    /* =========================
       Chapters Base
       ========================== */
    main{display:block;}
    .chapter{
      background:#000;
      padding:14vh 8vw;
      position:relative;
      isolation:isolate;
    }
    .chapter-inner{max-width:980px;margin:0 auto;}
    .kicker{
      color:rgba(255,255,255,0.7);
      letter-spacing:0.18em;
      font-size:0.9rem;
      margin-bottom:1.2rem;
      text-transform:uppercase;
    }
    .chapter h2{
      font-size:clamp(1.8rem,3.5vw,2.8rem);
      font-weight:900;
      letter-spacing:0.06em;
      margin-bottom:1.1rem;
      color:var(--gold);
    }
    .chapter p{
      font-size:clamp(1.05rem,1.6vw,1.2rem);
      line-height:1.95;
      color:var(--text);
      margin:0.9rem 0;
    }
    .chapter strong{color:rgba(255,255,255,0.98);}
    .note{
      color:rgba(255,255,255,0.72);
      font-size:0.98rem;
      line-height:1.85;
    }
    .hr{
      height:1px;
      background:rgba(255,255,255,0.12);
      margin:2.2rem 0;
    }

    .reveal{
      opacity:0;
      transform:translateY(14px);
      transition:opacity 0.8s ease, transform 0.8s ease;
    }
    .reveal.is-visible{opacity:1;transform:translateY(0);}

    /* =========================
       Sticky Compare / Sticky Narrative
       ========================== */
    .sticky-section{
      background:var(--red);
      padding:0;
      overflow:hidden;
      position:relative;
    }
    .sticky-section.grainy{position:relative;}

    .sticky-wrap{
      position:relative;
      z-index:1;
      display:grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap:min(5vw,60px);
      padding:12vh 8vw;
      align-items:start;
    }
    .sticky-media{
      position:sticky;
      top:calc(var(--navH) + 8px);
      border-radius:22px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(0,0,0,0.25);
      box-shadow:0 30px 80px rgba(0,0,0,0.45);
      isolation:isolate;
    }
    .sticky-media img, .sticky-media video{
      width:100%;
      height:min(72vh,720px);
      object-fit:cover;
      display:block;
    }
    .sticky-media::after{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(to bottom, rgba(0,0,0,0.14), rgba(0,0,0,0.38));
      pointer-events:none;
      z-index:2;
    }

    .sticky-text{padding-bottom:20vh;}
    .sticky-text .lead{
      color:rgba(255,255,255,0.88);
      font-size:clamp(1.1rem,1.8vw,1.25rem);
      line-height:1.95;
      margin:0.8rem 0 1.2rem;
    }
    .sticky-step{
      margin:0;
      padding:1.1rem 1.1rem;
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(0,0,0,0.18);
      transition:background 0.35s ease, border-color 0.35s ease, transform 0.35s ease;
      transform:translateY(0);
    }
    .sticky-step + .sticky-step{margin-top:1rem;}
    .sticky-step .label{
      display:block;
      letter-spacing:0.18em;
      text-transform:uppercase;
      font-size:0.82rem;
      color:rgba(255,255,255,0.70);
      margin-bottom:0.35rem;
    }
    .sticky-step.is-active{
      background:rgba(0,0,0,0.34);
      border-color:rgba(255,255,255,0.20);
      transform:translateY(-2px);
    }
    .sticky-step.is-active .label{color:rgba(255,232,122,0.85);}
    .sticky-step.is-active .text{color:rgba(255,255,255,0.98);}
    .sticky-step .text{
      color:rgba(255,255,255,0.86);
      font-size:clamp(1.05rem,1.7vw,1.2rem);
      line-height:1.95;
    }

    .tip{
      position:relative;
      border-bottom:1px dashed rgba(255,255,255,0.55);
      cursor:help;
    }
    .tip:hover::after{
      content:attr(data-tip);
      position:absolute;
      left:0;
      top:1.7em;
      width:min(320px,70vw);
      padding:10px 12px;
      background:rgba(0,0,0,.90);
      color:#fff;
      border:1px solid rgba(255,255,255,0.15);
      border-radius:14px;
      font-size:0.95rem;
      line-height:1.5;
      z-index:20;
    }

    /* =========================
       Chapter 03: order stage (scroll-lit)
       ========================== */
    .order-stage{
      border-radius:24px;
      padding:1.4rem 1.4rem 1.2rem;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(0,0,0,0.22);
      transition:background 0.8s ease, border-color 0.8s ease, filter 0.8s ease;
      filter:brightness(0.6) saturate(0.95);
    }
    .order-stage.is-lit{
      background:rgba(0,0,0,0.34);
      border-color:rgba(255,255,255,0.22);
      filter:brightness(1) saturate(1);
    }
    .order-stage p{margin:0.75rem 0;}

    /* =========================
       Horizontal Exhibit (Chapter 04)
       ========================== */
    .hscroll{
      padding:0;
      background:var(--red);
      position:relative;
      overflow:hidden;
    }
    .hscroll.grainy{position:relative;}

    .hscroll-head{
      position:relative;
      z-index:2;
      padding:12vh 8vw 4vh;
      max-width:980px;
      margin:0 auto;
    }
    .hscroll-head .note{color:rgba(255,255,255,0.74);}
    .hscroll-pin{
      position:sticky;
      top:var(--navH);
      height:calc(100vh - var(--navH));
      overflow:hidden;
      z-index:2;
      border-top:1px solid rgba(255,255,255,0.10);
      border-bottom:1px solid rgba(255,255,255,0.10);
      background:rgba(0,0,0,0.12);
    }
    .hscroll-track{
      height:100%;
      display:flex;
      width:600vw; /* JS 會自動改成 panels*100vw */
      transform:translateX(0px);
      will-change:transform;
    }
    .panel{
      width:100vw;
      height:100%;
      padding:8vh 8vw;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:min(5vw,60px);
      align-items:center;
    }
    .panel .panel-media{
      border-radius:22px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(0,0,0,0.25);
      box-shadow:0 30px 80px rgba(0,0,0,0.45);
      position:relative;
      isolation:isolate;
    }
    .panel .panel-media img,
    .panel .panel-media video{
      width:100%;
      height:min(60vh,620px);
      object-fit:cover;
      display:block;
      background:#000;
    }
    .panel .panel-media::after{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(to bottom, rgba(0,0,0,0.12), rgba(0,0,0,0.35));
      pointer-events:none;
      z-index:2;
    }
    .panel h3{
      font-size:clamp(1.8rem,3vw,2.4rem);
      font-weight:900;
      letter-spacing:0.12em;
      color:var(--gold);
      margin-bottom:0.55rem;
    }
    .panel .tagline{
      font-size:0.92rem;
      letter-spacing:0.22em;
      color:rgba(255,255,255,0.66);
      margin-bottom:1.0rem;
      text-transform:uppercase;
    }
    .panel .desc{
      color:rgba(255,255,255,0.90);
      font-size:clamp(1.05rem,1.6vw,1.2rem);
      line-height:1.95;
      margin:0.6rem 0 1.1rem;
    }
    .panel .cta{
      display:inline-flex;
      align-items:center;
      gap:0.55rem;
      font-size:0.95rem;
      letter-spacing:0.12em;
      color:rgba(255,255,255,0.88);
      user-select:none;
      cursor:pointer;
      border:1px solid rgba(255,255,255,0.20);
      background:rgba(0,0,0,0.16);
      padding:0.55rem 0.85rem;
      border-radius:999px;
      transition:0.25s ease;
    }
    .panel .cta:hover{
      border-color:rgba(255,255,255,0.32);
      background:rgba(0,0,0,0.26);
    }
    .hscroll-spacer{
      height:520vh; /* JS 會根據 panels 自動微調 */
      background:var(--red);
      position:relative;
      z-index:1;
    }

    /* =========================
       Scrolled Video (Chapter 05)
       ========================== */
    .sv-wrap{
      display:grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap:min(5vw,60px);
      align-items:start;
      margin-top:2.0rem;
    }
    .sv-video{
      position:sticky;
      top:calc(var(--navH) + 8px);
      border-radius:22px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.03);
      box-shadow:0 30px 80px rgba(0,0,0,0.45);
    }
    .sv-video video{
      width:100%;
      height:min(72vh,720px);
      object-fit:cover;
      display:block;
      background:#000;
    }
    .sv-lines{padding-bottom:30vh;}
    .sv-line{
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.10);
      background:rgba(255,255,255,0.04);
      padding:1.1rem 1.1rem;
      margin:0 0 1rem;
      transition:background 0.35s ease, border-color 0.35s ease, transform 0.35s ease;
    }
    .sv-line .who{
      margin-top:0.55rem;
      color:rgba(255,255,255,0.65);
      font-size:0.95rem;
      letter-spacing:0.08em;
    }
    .sv-line.is-active{
      background:rgba(255,255,255,0.08);
      border-color:rgba(255,255,255,0.18);
      transform:translateY(-2px);
    }
    .sv-line.is-active .quoteText{color:rgba(255,255,255,0.98);}
    .sv-line .quoteText{
      color:rgba(255,255,255,0.84);
      font-size:clamp(1.05rem,1.6vw,1.2rem);
      line-height:1.95;
    }

    /* =========================
       Modal
       ========================== */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.72);
      z-index:120;
      display:none;
      align-items:center;
      justify-content:center;
      padding:6vh 6vw;
    }
    .modal-backdrop.open{display:flex;}
    .modal{
      width:min(980px,100%);
      max-height:86vh;
      overflow:auto;
      background:rgba(10,10,10,0.96);
      border:1px solid rgba(255,255,255,0.16);
      border-radius:24px;
      padding:1.4rem 1.4rem 1.2rem;
      box-shadow:0 30px 80px rgba(0,0,0,0.6);
    }
    .modal-header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:1rem;
      margin-bottom:0.8rem;
    }
    .modal-title{
      font-size:1.6rem;
      font-weight:900;
      letter-spacing:0.10em;
      color:var(--gold);
    }
    .modal-close{
      appearance:none;
      border:1px solid rgba(255,255,255,0.20);
      background:rgba(255,255,255,0.06);
      color:rgba(255,255,255,0.92);
      border-radius:999px;
      padding:0.55rem 0.85rem;
      cursor:pointer;
      font-size:0.95rem;
      letter-spacing:0.12em;
    }
    .modal-close:hover{border-color:rgba(255,255,255,0.28);}
    .modal-body p{margin:0.8rem 0;}
    .modal-media{margin-top:1rem;}
    .modal-media video, .modal-media img{
      width:100%;
      border-radius:18px;
      display:block;
      border:1px solid rgba(255,255,255,0.10);
      background:rgba(255,255,255,0.03);
    }
    .modal-caption{
      margin-top:0.7rem;
      color:rgba(255,255,255,0.72);
      font-size:0.95rem;
      line-height:1.6;
    }

    @media (prefers-reduced-motion: reduce){
      html{scroll-behavior:auto !important;}
      *{scroll-behavior:auto !important;}
      .hero-entrance,.reveal{transition:none !important;transform:none !important;}
      .scroll-hint{animation:none !important;}
      .typewriter-line.typing::after{animation:none !important;}
      .fog-layer{animation:none !important;}
      .fog-layer::before,.fog-layer::after{animation:none !important;}
    }

    @media (max-width: 900px){
      :root{ --navH: 86px; }
      .sticky-wrap, .sv-wrap{grid-template-columns:1fr;}
      .sticky-media, .sv-video{top:calc(var(--navH) + 8px);}
      .sticky-media img, .sticky-media video, .sv-video video{height:56vh;}
      .panel{
        grid-template-columns:1fr;
        align-content:start;
        padding:6vh 8vw;
      }
      .panel .panel-media img, .panel .panel-media video{height:40vh;}
    }
    @media (max-width: 768px){
      .hero{padding:4vh 8vw;}
      .hero-content{flex:1 1 auto;min-height:auto;}
      .hero-image{right:-5vw;bottom:1rem;opacity:0.62;}
      .hero-image img{width:min(78vw,420px);max-height:60vh;}
      .hero h1,.hero h2{white-space:normal;}
      .scroll-hint{letter-spacing:0.2em;bottom:2rem;}
      .mini-nav-inner{padding:0.65rem 6vw 0.55rem;}
      .progressbar{margin:0 6vw 0.55rem;}
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#main">跳到正文</a>
  <div class="fog-layer" aria-hidden="true"></div>

  <!-- Section 1: Landing Video -->
  <section class="landing-video" aria-label="開場舞台影片">
    <video
      id="landing-video"
      src="video/stage.mp4"
      autoplay
      muted
      loop
      playsinline
      preload="auto"
    ></video>
  </section>

  <!-- Section 2: Buffer -->
  <section class="buffer grainy" aria-hidden="true"></section>

  <!-- Section 3: Hero -->
  <section class="hero grainy" aria-label="專題標題">
    <div class="hero-content">
      <h1 id="hero-title" class="typewriter-line hero-entrance" data-text="唱給不在場的人" style="--delay:0ms;"></h1>
      <h2 id="hero-subtitle" class="typewriter-line hero-entrance" data-text="紅包歌手的世代誤解與生存現場" style="--delay:150ms;"></h2>
      <h3 id="hero-author" class="hero-author hero-entrance" style="--delay:300ms;">梁朝勛、彭賀琳、莊馨予</h3>
    </div>
    <div class="hero-image hero-entrance" style="--delay:0ms;">
      <img
        src="photo/yang-yaqiao.jpg"
        alt="紅包場歌手楊雅喬"
        decoding="async"
        loading="eager"
        fetchpriority="high"
      />
    </div>
    <div id="scroll-hint" class="scroll-hint">SCROLL ↓</div>
  </section>

  <!-- Mini Nav -->
  <nav class="mini-nav" aria-label="章節導覽">
    <div class="mini-nav-inner" role="navigation">
      <a href="#chapter-hook" data-section="chapter-hook">01 HOOK</a>
      <a href="#chapter-redpacket" data-section="chapter-redpacket">02 紅包</a>
      <a href="#chapter-order" data-section="chapter-order">03 秩序</a>
      <a href="#chapter-elements" data-section="chapter-elements">04 六大元素</a>
      <a href="#chapter-interviews" data-section="chapter-interviews">05 訪談</a>
    </div>
    <div class="progressbar" aria-hidden="true"><div id="progress-fill"></div></div>
  </nav>

  <main id="main">
    <!-- Chapter 01 -->
    <section class="chapter sticky-section grainy" id="chapter-hook" aria-label="章節一：紅包場與刻板印象">
      <div class="sticky-wrap">
        <div class="sticky-media" aria-hidden="true">
          <img
            id="compare-media"
            src="photo/DSC04754.jpg"
            alt="紅包場內景"
            loading="eager"
            decoding="async"
          />
        </div>

        <div class="sticky-text">
          <div class="kicker reveal">CHAPTER 01</div>
          <h2 class="reveal">紅包場，和你想的不一樣</h2>
          <p class="lead reveal">把它誤會成「某種刺激消費」很容易；但真正的樣貌，往往只在你坐下來之後，才慢慢浮現。</p>

          <div class="sticky-step reveal js-sticky-step is-active" data-kind="img" data-media="photo/DSC04754.jpg">
            <span class="label">COMPARE 01</span>
            <div class="text">它常被拿來和 <span class="tip" data-tip="紅包場不以「清涼」或「火辣」為賣點">牛肉場</span>混為一談，但紅包場的核心是「聽歌」：觀眾把注意力給表演，歌手把完整的演出給舞台。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step" data-kind="img" data-media="photo/singer.jpg">
            <span class="label">COMPARE 02</span>
            <div class="text">它也不等同 <span class="tip" data-tip="紅包場是老少宜的場所">舞廳</span>。紅包場裡，主角始終在台上，秩序與默契反而更像一套「固定座位的劇場」。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step" data-kind="img" data-media="photo/DSC04900.jpg">
            <span class="label">COMPARE 03</span>
            <div class="text">你可以把它和 <span class="tip" data-tip="紅包場觀眾不會上台唱歌">卡拉OK</span>區分開來：紅包場觀眾多半不登台，點歌、聽歌、聊天，維持的是「台上台下」的距離。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step" data-kind="img" data-media="photo/DSC09319.jpg">
            <span class="label">COMPARE 04</span>
            <div class="text">它也不同於 <span class="tip" data-tip="紅包場歌手需要穿著「禮服」上台">Livehouse</span>。紅包場的舞台更像「秀場」：禮服、燈光、稱號、流程，構成一種職業規範。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step" data-kind="img" data-media="photo/DSC09375.jpg">
            <span class="label">COMPARE 05</span>
            <div class="text">更別說 <span class="tip" data-tip="紅包場的觀眾是特地來聽歌的">流水席</span>：紅包場的觀眾是為了歌而來，餐飲只是把時間留在現場的方式。</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Chapter 02 -->
    <section class="chapter sticky-section grainy" id="chapter-redpacket" aria-label="章節二：紅包的意義">
      <div class="sticky-wrap">
        <div class="sticky-media">
          <video id="redpacket-loop" muted loop playsinline preload="metadata" poster="photo/DSC09375.jpg">
            <source src="video/c0621.mp4" type="video/mp4" />
          </video>
        </div>

        <div class="sticky-text">
          <div class="kicker reveal">CHAPTER 02</div>
          <h2 class="reveal">紅包的意義：支持表演，而不是購買身體</h2>

          <p class="lead reveal">把「紅包」理解成交易，很快；但在現場，它更像一種回應：喜歡、尊重、面子、人情，最後都落在一個小小的信封裡。</p>

          <div class="sticky-step reveal js-sticky-step-2 is-active" data-kind="img" data-media="photo/DSC04754.jpg">
            <span class="label">POINT 01</span>
            <div class="text">紅包場是歌手、表演者與觀眾最直接互動的地方。觀眾用紅包表達喜歡，歌手用表演回應掌聲。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step-2" data-kind="img" data-media="photo/redpacket.jpg">
            <span class="label">POINT 02</span>
            <div class="text">紅包不是對身體的購買，而是對「表演」的支持；觀眾來聽歌、點歌、聊天，建立的是長時間的人情關係。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step-2" data-kind="img" data-media="photo/DSC09375.jpg">
            <span class="label">POINT 03</span>
            <div class="text">紅包場的文化內涵，來自「茶單」制度：歌星承擔賓客的飲食消費，賓客則包高出消費金額的紅包交給所捧場的歌星。</div>
          </div>

          <div class="sticky-step reveal js-sticky-step-2" data-kind="img" data-media="photo/assistant.jpg">
            <span class="label">POINT 04</span>
            <div class="text">多出來的金額成為鼓勵，也讓「紅包」成為關係的可見形式：不是一次性的刺激消費，而是累積的信任與照顧。</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Chapter 03 -->
    <section class="chapter" id="chapter-order" aria-label="章節三：仍在運作的秩序">
      <div class="chapter-inner">
        <div class="kicker reveal">CHAPTER 03</div>
        <h2 class="reveal">一個仍在運作的秩序</h2>

        <div class="order-stage reveal" id="order-stage">
          <p class="js-order-line">坐進觀眾席後，紅包場的日常很快展開。茶水與水果盤被送上桌，「小妹」在場內來回穿梭，確認每一桌的狀態。</p>
          <p class="js-order-line">對第一次進場的人來說，這套秩序未必容易理解：座位距離近，舞台與觀眾幾乎沒有明確分界；任何多餘的動作，都顯得突兀。</p>
          <p class="js-order-line">這種不自在，並非來自危險或衝突，而是來自——<strong>不知道自己該如何被放進這個空間</strong>。</p>
        </div>

        <div class="hr reveal"></div>

        <p class="reveal js-order-line">在現場，新面孔很少被直接問「覺得好不好」。更常出現的，是另一個問題：<strong>「怎麼會來這裡？」</strong></p>
        <p class="note reveal js-order-line">年輕人的出現往往被理解成「帶著目的」：作業、報導、拍攝、找題材。於是紅包場面對新世代時，常同時帶著開放與防備。</p>
      </div>
    </section>

    <!-- Chapter 04 -->
    <section class="chapter hscroll grainy" id="chapter-elements" aria-label="章節四：六大元素">
      <div class="hscroll-head">
        <div class="kicker reveal">CHAPTER 04</div>
        <h2 class="reveal">撐起紅包場的人與物</h2>
        <p class="reveal">把六大元素做成走廊式展覽：你不是讀清單，而是被帶著走進場內，逐一看見系統如何運作。</p>
        <p class="note reveal">操作：慢慢往下捲（這段會橫向推進）。點「展開更多」可打開深度素材。</p>
      </div>

      <div class="hscroll-pin" aria-hidden="false">
        <div class="hscroll-track" id="hscroll-track">
          <!-- 01 歌星 -->
          <section class="panel"
            data-title="歌星"
            data-subtitle="THE SINGER"
            data-body="歌星輪番登台，每人2-3首歌曲的時間，跑馬燈穿過個人稱號。禮服、燈光、流程，是職業規範，也是身段。紅包場曾捧紅無數在地舞台與電視螢幕的名字，而在今天，歌星仍用唱功與時間換取掌聲與信任。"
            data-media-type="img"
            data-media-src="photo/singer.jpg"
            data-media-caption="舞台上的歌星（photo/singer.jpg）">
            <div>
              <h3>歌星</h3>
              <div class="tagline">THE SINGER</div>
              <div class="desc">輪番登台、禮服盛裝。二到三首歌的時間，是一輩子累積的職業身段。</div>
              <button class="cta js-open-modal" type="button">＋ 展開更多</button>
            </div>
            <div class="panel-media">
              <img src="photo/singer.jpg" alt="歌星｜舞台畫面" loading="lazy" decoding="async">
            </div>
          </section>

          <!-- 02 樂團老師 -->
          <section class="panel"
            data-title="樂團老師"
            data-subtitle="THE BAND"
            data-body="樂團老師把每一段過門與節拍撐住：跟著歌星的key、跟著現場的呼吸，讓一場秀不只是歌，而是一套完整的演出。你看見的是台上，聽見的是多年默契。"
            data-media-type="img"
            data-media-src="photo/DSC04900.jpg"
            data-media-caption="樂隊與舞台的距離（photo/DSC04900.jpg）">
            <div>
              <h3>樂團老師</h3>
              <div class="tagline">THE BAND</div>
              <div class="desc">一首歌的穩，是很多晚上的熟練。台上不說話，但每個音都在指揮秩序。</div>
              <button class="cta js-open-modal" type="button">＋ 展開更多</button>
            </div>
            <div class="panel-media">
              <img src="photo/DSC04900.jpg" alt="樂團老師｜現場" loading="lazy" decoding="async">
            </div>
          </section>

          <!-- 03 小妹 -->
          <section class="panel"
            data-title="小妹"
            data-subtitle="THE RUNNER"
            data-body="小妹在場內穿梭：送茶水、加冰塊、確認每桌狀態，處理那些不會被寫在節目單上的細節。對外人來說是服務；對場內的人來說，是讓一切不出錯的節點。"
            data-media-type="img"
            data-media-src="photo/assistant.jpg"
            data-media-caption="穿梭在桌與桌之間（photo/assistant.jpg）">
            <div>
              <h3>小妹</h3>
              <div class="tagline">THE RUNNER</div>
              <div class="desc">走動、記住、補位。她不是配角，而是現場能不能順的關鍵。</div>
              <button class="cta js-open-modal" type="button">＋ 展開更多</button>
            </div>
            <div class="panel-media">
              <img src="photo/assistant.jpg" alt="小妹｜服務動線" loading="lazy" decoding="async">
            </div>
          </section>

          <!-- 04 老闆 / 場域 -->
          <section class="panel"
            data-title="場域與老闆"
            data-subtitle="THE HOUSE"
            data-body="燈光怎麼亮、哪一桌坐誰、什麼時候該上菜、該不該提醒——場域本身像一台老機器，靠人維修、靠經驗運轉。老闆與幹部的角色，是把規則留在空氣裡。"
            data-media-type="img"
            data-media-src="photo/DSC09319.jpg"
            data-media-caption="舞台、桌席與距離（photo/DSC09319.jpg）">
            <div>
              <h3>場域與老闆</h3>
              <div class="tagline">THE HOUSE</div>
              <div class="desc">你以為是「地方」，其實是一套制度：誰能靠近舞台、誰該被保護。</div>
              <button class="cta js-open-modal" type="button">＋ 展開更多</button>
            </div>
            <div class="panel-media">
              <img src="photo/DSC09319.jpg" alt="場域｜視線與距離" loading="lazy" decoding="async">
            </div>
          </section>

          <!-- 05 茶單 -->
          <section class="panel"
            data-title="茶單"
            data-subtitle="THE TAB"
            data-body="茶單不只是點餐。它把消費與人情綁在一起：歌星承擔桌上的飲食，觀眾用紅包回敬。制度讓關係可被計算，也讓關係不只是錢——它被解讀成尊重、面子、回應。"
            data-media-type="img"
            data-media-src="photo/redpacket.jpg"
            data-media-caption="紅包與茶單的象徵（photo/redpacket.jpg）">
            <div>
              <h3>茶單</h3>
              <div class="tagline">THE TAB</div>
              <div class="desc">一張單，連起歌聲與人情。不是「付費」，更像是「回應」。</div>
              <button class="cta js-open-modal" type="button">＋ 展開更多</button>
            </div>
            <div class="panel-media">
              <img src="photo/redpacket.jpg" alt="茶單｜紅包象徵" loading="lazy" decoding="async">
            </div>
          </section>

          <!-- 06 觀眾 -->
          <section class="panel"
            data-title="觀眾"
            data-subtitle="THE REGULARS"
            data-body="觀眾不是一群陌生人。有人是老主顧，有人是路過坐下的人；有人為了一首歌回來很多次。對歌星而言，觀眾是一段段被記住的關係：點歌、問候、照顧，和偶爾的沉默。"
            data-media-type="img"
            data-media-src="photo/DSC09375.jpg"
            data-media-caption="桌席、眼神與停留（photo/DSC09375.jpg）">
            <div>
              <h3>觀眾</h3>
              <div class="tagline">THE REGULARS</div>
              <div class="desc">紅包場的時間，不只在台上，也在每張桌子旁邊的停留。</div>
              <button class="cta js-open-modal" type="button">＋ 展開更多</button>
            </div>
            <div class="panel-media">
              <img src="photo/DSC09375.jpg" alt="觀眾｜桌席氛圍" loading="lazy" decoding="async">
            </div>
          </section>
        </div>
      </div>

      <div class="hscroll-spacer" id="hscroll-spacer" aria-hidden="true"></div>
    </section>

    <!-- Chapter 05 -->
    <section class="chapter" id="chapter-interviews" aria-label="章節五：訪談與聲音">
      <div class="chapter-inner">
        <div class="kicker reveal">CHAPTER 05</div>
        <h2 class="reveal">把聲音留下來：她們如何看見自己</h2>
        <p class="reveal">這一段用「左側固定影片＋右側引言高亮」讓讀者跟著一句句話走。你之後可以把逐字稿精選貼進去。</p>

        <div class="sv-wrap">
          <div class="sv-video reveal">
            <video id="interview-video" muted playsinline preload="metadata" poster="photo/yang-yaqiao.jpg">
              <source src="video/c0621.mp4" type="video/mp4" />
            </video>
          </div>

          <div class="sv-lines">
            <div class="sv-line reveal js-sv-line is-active">
              <div class="quoteText">「大家以為紅包是在買什麼，但其實我們賣的是表演、是專業。」</div>
              <div class="who">— 受訪者 A（可改成：楊雅喬）</div>
            </div>

            <div class="sv-line reveal js-sv-line">
              <div class="quoteText">「一上台就要把狀態撐住，哪怕台下有人不理解，你也得把一首歌唱完。」</div>
              <div class="who">— 受訪者 A</div>
            </div>

            <div class="sv-line reveal js-sv-line">
              <div class="quoteText">「真正懂的人不會吵，他們坐著聽，紅包只是最後的回應。」</div>
              <div class="who">— 受訪者 B（可改成：護心／團長或觀眾）</div>
            </div>

            <div class="sv-line reveal js-sv-line">
              <div class="quoteText">「你以為這裡很亂，但其實規矩很多：怎麼走、怎麼坐、怎麼看舞台。」</div>
              <div class="who">— 受訪者 B</div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal -->
  <div class="modal-backdrop" id="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-title">TITLE</div>
        <button class="modal-close" id="modal-close" type="button" aria-label="關閉">關閉 ×</button>
      </div>
      <div class="modal-body" id="modal-body"></div>
      <div class="modal-media" id="modal-media"></div>
      <div class="modal-caption" id="modal-caption"></div>
    </div>
  </div>

  <script>
    // ============= Helpers =============
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    function clamp(n, min, max){ return Math.min(max, Math.max(min, n)); }

    function setActiveStep(steps, activeEl){
      steps.forEach(s => s.classList.toggle('is-active', s === activeEl));
    }

    function setStickyMedia(containerEl, kind, src){
      // containerEl = .sticky-media
      if(!containerEl) return;
      const oldVideo = containerEl.querySelector('video');
      const oldImg = containerEl.querySelector('img');

      if(kind === 'video'){
        if(oldImg) oldImg.remove();
        if(!oldVideo){
          const v = document.createElement('video');
          v.muted = true;
          v.loop = true;
          v.playsInline = true;
          v.preload = 'metadata';
          const s = document.createElement('source');
          s.src = src;
          s.type = 'video/mp4';
          v.appendChild(s);
          containerEl.prepend(v);
          v.play().catch(()=>{});
        }else{
          const source = oldVideo.querySelector('source');
          if(source && source.src !== src){
            source.src = src;
            oldVideo.load();
          }
          oldVideo.play().catch(()=>{});
        }
      }else{
        // img
        if(oldVideo) oldVideo.pause();
        if(oldVideo) oldVideo.remove();
        if(oldImg){
          oldImg.src = src;
        }else{
          const img = document.createElement('img');
          img.src = src;
          img.alt = "";
          img.loading = "eager";
          img.decoding = "async";
          containerEl.prepend(img);
        }
      }
    }

    // ============= Hero entrance + typewriter =============
    (function initHero(){
      const heroEls = document.querySelectorAll('.hero-entrance');
      requestAnimationFrame(()=> heroEls.forEach(el=> el.classList.add('is-visible')));

      const lines = [
        document.getElementById('hero-title'),
        document.getElementById('hero-subtitle')
      ].filter(Boolean);

      function typeLine(el, speed=55){
        return new Promise(resolve=>{
          const text = el.getAttribute('data-text') || '';
          if(prefersReduced){
            el.textContent = text;
            el.classList.add('done');
            resolve();
            return;
          }
          el.textContent = '';
          el.classList.add('typing');
          let i = 0;
          const tick = () => {
            el.textContent = text.slice(0, i);
            i++;
            if(i <= text.length){
              setTimeout(tick, speed);
            }else{
              el.classList.remove('typing');
              el.classList.add('done');
              resolve();
            }
          };
          tick();
        });
      }

      (async ()=>{
        for(const el of lines){
          await typeLine(el, 55);
          await new Promise(r=> setTimeout(r, 180));
        }
        const hint = document.getElementById('scroll-hint');
        if(hint) hint.classList.add('visible');
      })();
    })();

    // ============= Reveal on scroll =============
    (function initReveal(){
      const els = document.querySelectorAll('.reveal');
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            e.target.classList.add('is-visible');
            io.unobserve(e.target);
          }
        });
      }, {threshold: 0.12});
      els.forEach(el=> io.observe(el));
    })();

    // ============= Mini nav active + progress bar =============
    (function initNav(){
      const links = Array.from(document.querySelectorAll('.mini-nav a[data-section]'));
      const sections = links
        .map(a => document.getElementById(a.dataset.section))
        .filter(Boolean);

      const fill = document.getElementById('progress-fill');

      function updateProgress(){
        const doc = document.documentElement;
        const scrollTop = doc.scrollTop || document.body.scrollTop;
        const scrollHeight = doc.scrollHeight - doc.clientHeight;
        const p = scrollHeight > 0 ? (scrollTop / scrollHeight) : 0;
        if(fill) fill.style.width = (p*100).toFixed(2) + '%';
      }

      const sio = new IntersectionObserver((entries)=>{
        // pick the most visible section
        let best = null;
        entries.forEach(e=>{
          if(!best || e.intersectionRatio > best.intersectionRatio){
            best = e;
          }
        });
        if(best && best.isIntersecting){
          const id = best.target.id;
          links.forEach(a => a.classList.toggle('active', a.dataset.section === id));
        }
      }, {threshold: [0.22, 0.35, 0.5, 0.65]});

      sections.forEach(sec => sio.observe(sec));
      window.addEventListener('scroll', updateProgress, {passive:true});
      updateProgress();
    })();

    // ============= Sticky media switch (Chapter 01 + 02) =============
    (function initStickySwitch(){
      // Chapter 01
      const steps1 = Array.from(document.querySelectorAll('.js-sticky-step'));
      const stickyMedia1 = document.querySelector('#chapter-hook .sticky-media');
      const io1 = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            const el = e.target;
            setActiveStep(steps1, el);
            const kind = el.dataset.kind || 'img';
            const src = el.dataset.media;
            setStickyMedia(stickyMedia1, kind, src);
          }
        });
      }, {threshold: 0.55});
      steps1.forEach(s=> io1.observe(s));

      // Chapter 02
      const steps2 = Array.from(document.querySelectorAll('.js-sticky-step-2'));
      const stickyMedia2 = document.querySelector('#chapter-redpacket .sticky-media');
      const io2 = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            const el = e.target;
            setActiveStep(steps2, el);
            const kind = el.dataset.kind || 'img';
            const src = el.dataset.media;
            setStickyMedia(stickyMedia2, kind, src);
          }
        });
      }, {threshold: 0.55});
      steps2.forEach(s=> io2.observe(s));

      // auto play loop video when visible
      const redLoop = document.getElementById('redpacket-loop');
      if(redLoop){
        const vio = new IntersectionObserver((entries)=>{
          entries.forEach(e=>{
            if(e.isIntersecting){
              redLoop.play().catch(()=>{});
            }else{
              redLoop.pause();
            }
          });
        }, {threshold: 0.2});
        vio.observe(redLoop);
      }
    })();

    // ============= Chapter 03 "light up" =============
    (function initOrderStage(){
      const stage = document.getElementById('order-stage');
      if(!stage) return;
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          stage.classList.toggle('is-lit', e.isIntersecting);
        });
      }, {threshold: 0.35});
      io.observe(stage);
    })();

    // ============= Chapter 04 Horizontal scroll =============
    (function initHScroll(){
      const section = document.getElementById('chapter-elements');
      const track = document.getElementById('hscroll-track');
      const spacer = document.getElementById('hscroll-spacer');
      if(!section || !track || !spacer) return;

      const panels = Array.from(track.querySelectorAll('.panel'));
      const n = panels.length || 1;
      track.style.width = (n * 100) + 'vw';

      // spacer height: each panel ~ 90vh scroll
      const scrollPerPanel = 90; // vh
      spacer.style.height = (scrollPerPanel * (n - 1) + 120) + 'vh';

      function update(){
        const pin = section.querySelector('.hscroll-pin');
        if(!pin) return;

        const rect = spacer.getBoundingClientRect();
        const viewH = window.innerHeight;
        const total = spacer.offsetHeight - viewH;
        const progressed = clamp((-rect.top) / (total || 1), 0, 1);

        const maxX = (n - 1) * window.innerWidth;
        const x = progressed * maxX;
        track.style.transform = `translateX(${-x}px)`;
      }

      window.addEventListener('scroll', update, {passive:true});
      window.addEventListener('resize', update);
      update();
    })();

    // ============= Modal from panels =============
    (function initModal(){
      const backdrop = document.getElementById('modal-backdrop');
      const closeBtn = document.getElementById('modal-close');
      const titleEl = document.getElementById('modal-title');
      const bodyEl = document.getElementById('modal-body');
      const mediaEl = document.getElementById('modal-media');
      const capEl = document.getElementById('modal-caption');

      function openModal(data){
        if(!backdrop) return;
        backdrop.classList.add('open');
        backdrop.setAttribute('aria-hidden', 'false');

        titleEl.textContent = data.title || '';
        bodyEl.innerHTML = '';
        mediaEl.innerHTML = '';
        capEl.textContent = data.caption || '';

        if(data.body){
          const p = document.createElement('p');
          p.textContent = data.body;
          bodyEl.appendChild(p);
        }

        if(data.mediaType === 'video'){
          const v = document.createElement('video');
          v.controls = true;
          v.playsInline = true;
          v.preload = 'metadata';
          const s = document.createElement('source');
          s.src = data.mediaSrc;
          s.type = 'video/mp4';
          v.appendChild(s);
          mediaEl.appendChild(v);
        }else if(data.mediaSrc){
          const img = document.createElement('img');
          img.src = data.mediaSrc;
          img.alt = data.title || '';
          img.loading = 'lazy';
          img.decoding = 'async';
          mediaEl.appendChild(img);
        }

        // focus for a11y
        closeBtn.focus();
        document.body.style.overflow = 'hidden';
      }

      function closeModal(){
        if(!backdrop) return;
        backdrop.classList.remove('open');
        backdrop.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      }

      document.querySelectorAll('.js-open-modal').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const panel = btn.closest('.panel');
          if(!panel) return;
          openModal({
            title: panel.dataset.title,
            body: panel.dataset.body,
            mediaType: panel.dataset.mediaType || 'img',
            mediaSrc: panel.dataset.mediaSrc,
            caption: panel.dataset.mediaCaption || ''
          });
        });
      });

      closeBtn && closeBtn.addEventListener('click', closeModal);
      backdrop && backdrop.addEventListener('click', (e)=>{
        if(e.target === backdrop) closeModal();
      });
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape' && backdrop.classList.contains('open')) closeModal();
      });
    })();

    // ============= Chapter 05 scroll-highlight + video play/pause =============
    (function initInterview(){
      const video = document.getElementById('interview-video');
      const lines = Array.from(document.querySelectorAll('.js-sv-line'));

      if(video){
        const vio = new IntersectionObserver((entries)=>{
          entries.forEach(e=>{
            if(e.isIntersecting){
              video.play().catch(()=>{});
            }else{
              video.pause();
            }
          });
        }, {threshold: 0.25});
        vio.observe(video);
      }

      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            lines.forEach(l=> l.classList.toggle('is-active', l === e.target));
          }
        });
      }, {threshold: 0.55});
      lines.forEach(l=> io.observe(l));
    })();
  </script>
</body>
</html>
