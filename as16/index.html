<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>唱給不在場的人</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
:root{
  --red:#970C10;
  --gold:#FFE87A;
  --ink:#000;
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.65);
  --navH:92px;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:"Noto Serif TC",serif;
  background:#000;
  color:#fff;
  overflow-x:hidden;
}

/* ===== Mini Nav ===== */
.mini-nav{
  position:sticky;
  top:0;
  z-index:50;
  backdrop-filter:blur(10px);
  background:rgba(0,0,0,.55);
  border-bottom:1px solid rgba(255,255,255,.12);
}
.mini-nav-inner{
  display:flex;
  gap:1rem;
  padding:.7rem 6vw;
  overflow-x:auto;
}
.mini-nav a{
  white-space:nowrap;
  font-size:.9rem;
  letter-spacing:.12em;
  padding:.35rem .7rem;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.18);
  text-decoration:none;
  color:rgba(255,255,255,.75);
}
.mini-nav a.active{
  background:var(--gold);
  color:#000;
  border-color:transparent;
}
.progressbar{
  height:3px;
  background:rgba(255,255,255,.12);
}
.progressbar div{
  height:100%;
  width:0%;
  background:var(--gold);
  transition:width .1s linear;
}

/* ===== Chapter Base ===== */
.chapter{
  padding:14vh 8vw;
}
.kicker{
  font-size:.85rem;
  letter-spacing:.18em;
  color:var(--muted);
}
.chapter h2{
  font-size:clamp(1.8rem,3.5vw,2.6rem);
  font-weight:900;
  letter-spacing:.08em;
  color:var(--gold);
  margin:.6rem 0 1rem;
}
.chapter p{
  font-size:clamp(1.05rem,1.6vw,1.2rem);
  line-height:1.9;
  color:var(--text);
}

/* ===== Chapter 04 Horizontal Exhibit ===== */
.hscroll{
  background:var(--red);
  padding:0;
  position:relative;
}
.hscroll-head{
  padding:12vh 8vw 4vh;
  max-width:980px;
  margin:auto;
}
.hscroll-progress{
  position:absolute;
  top:1.2rem;
  left:8vw;
  z-index:3;
  font-size:.85rem;
  letter-spacing:.22em;
  color:rgba(255,232,122,.95);
}
.hscroll-pin{
  position:sticky;
  top:var(--navH);
  height:calc(100vh - var(--navH));
  overflow:hidden;
  border-top:1px solid rgba(255,255,255,.15);
  border-bottom:1px solid rgba(255,255,255,.15);
}
.hscroll-track{
  display:flex;
  height:100%;
  will-change:transform;
}
.panel{
  width:100vw;
  height:100%;
  padding:8vh 8vw;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:4vw;
  align-items:center;
}
.panel h3{
  font-size:clamp(1.8rem,3vw,2.3rem);
  letter-spacing:.15em;
  color:var(--gold);
}
.panel .tagline{
  font-size:.85rem;
  letter-spacing:.25em;
  color:var(--muted);
  margin:.5rem 0 1rem;
}
.panel .desc{
  line-height:1.9;
}
.panel-media{
  border-radius:22px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.18);
}
.panel-media img{
  width:100%;
  height:60vh;
  object-fit:cover;
  display:block;
}
.hscroll-spacer{
  height:500vh;
}

/* ===== Mobile ===== */
@media(max-width:900px){
  .panel{grid-template-columns:1fr}
  .panel-media img{height:40vh}
}
</style>
</head>

<body>

<nav class="mini-nav">
  <div class="mini-nav-inner">
    <a href="#chapter-elements" class="active">04 六大元素</a>
  </div>
  <div class="progressbar"><div id="progress-fill"></div></div>
</nav>

<main>

<section class="chapter hscroll" id="chapter-elements">
  <div class="hscroll-head">
    <div class="kicker">CHAPTER 04</div>
    <h2>撐起紅包場的人與物</h2>
    <p>慢慢往下捲，這段會橫向推進。</p>
  </div>

  <div class="hscroll-progress" id="hscroll-progress">ELEMENT 1 / 6</div>

  <div class="hscroll-pin">
    <div class="hscroll-track" id="hscroll-track">
      <!-- 6 panels（內容略，保留你原本的即可） -->
    </div>
  </div>

  <div class="hscroll-spacer" id="hscroll-spacer"></div>
</section>

</main>

<script>
document.addEventListener("DOMContentLoaded",()=>{

const track=document.getElementById("hscroll-track");
const spacer=document.getElementById("hscroll-spacer");
const section=document.getElementById("chapter-elements");
const indicator=document.getElementById("hscroll-progress");
const panels=track.children.length;

track.style.width=`${panels*100}vw`;
spacer.style.height=`${(panels-1)*100+40}vh`;

let running=false, rafId=null;

const clamp=(n,min,max)=>Math.max(min,Math.min(max,n));

const render=()=>{
  const rect=section.getBoundingClientRect();
  const start=window.innerHeight*0.2;
  const end=rect.height-window.innerHeight*0.8;
  const t=clamp((start-rect.top)/end,0,1);
  const x=t*(panels-1)*window.innerWidth;
  track.style.transform=`translateX(-${x}px)`;
  const index=Math.round(t*(panels-1))+1;
  indicator.textContent=`ELEMENT ${index} / ${panels}`;
  rafId=requestAnimationFrame(render);
};

const io=new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(e.isIntersecting && !running){
      running=true;
      render();
    }
    if(!e.isIntersecting && running){
      cancelAnimationFrame(rafId);
      running=false;
    }
  });
},{threshold:.2});

io.observe(section);

});
</script>

</body>
</html>
